import{S as B,i as D,s as M,F as N,d as J,t as R,a as T,m as j,c as z,J as O,f as I,h as b,j as Q,k as K,l as g,n as c,o as A,E as U,q as V,G as X,u as _,A as P,v as k,w as f,p as L,K as Y,r as Z,I as y,z as q}from"./index-BozUHKR0.js";function W(o){let e,n,s;return{c(){e=P("для "),n=_("strong"),s=P(o[3]),f(n,"class","txt-nowrap")},m(l,t){g(l,e,t),g(l,n,t),c(n,s)},p(l,t){t&8&&y(s,l[3])},d(l){l&&(b(e),b(n))}}}function x(o){let e,n,s,l,t,r,p,d;return{c(){e=_("label"),n=P("Новый пароль"),l=k(),t=_("input"),f(e,"for",s=o[8]),f(t,"type","password"),f(t,"id",r=o[8]),t.required=!0,t.autofocus=!0},m(u,a){g(u,e,a),c(e,n),g(u,l,a),g(u,t,a),q(t,o[0]),t.focus(),p||(d=A(t,"input",o[6]),p=!0)},p(u,a){a&256&&s!==(s=u[8])&&f(e,"for",s),a&256&&r!==(r=u[8])&&f(t,"id",r),a&1&&t.value!==u[0]&&q(t,u[0])},d(u){u&&(b(e),b(l),b(t)),p=!1,d()}}}function ee(o){let e,n,s,l,t,r,p,d;return{c(){e=_("label"),n=P("Подтверждение нового пароля"),l=k(),t=_("input"),f(e,"for",s=o[8]),f(t,"type","password"),f(t,"id",r=o[8]),t.required=!0},m(u,a){g(u,e,a),c(e,n),g(u,l,a),g(u,t,a),q(t,o[1]),p||(d=A(t,"input",o[7]),p=!0)},p(u,a){a&256&&s!==(s=u[8])&&f(e,"for",s),a&256&&r!==(r=u[8])&&f(t,"id",r),a&2&&t.value!==u[1]&&q(t,u[1])},d(u){u&&(b(e),b(l),b(t)),p=!1,d()}}}function te(o){let e,n,s,l,t,r,p,d,u,a,w,S,C,v,h,F,E,m=o[3]&&W(o);return r=new I({props:{class:"form-field required",name:"password",$$slots:{default:[x,({uniqueId:i})=>({8:i}),({uniqueId:i})=>i?256:0]},$$scope:{ctx:o}}}),d=new I({props:{class:"form-field required",name:"passwordConfirm",$$slots:{default:[ee,({uniqueId:i})=>({8:i}),({uniqueId:i})=>i?256:0]},$$scope:{ctx:o}}}),{c(){e=_("form"),n=_("div"),s=_("h4"),l=P(`Сброс пароля суперпользователя
                `),m&&m.c(),t=k(),z(r.$$.fragment),p=k(),z(d.$$.fragment),u=k(),a=_("button"),w=_("span"),w.textContent="Установить новый пароль",S=k(),C=_("div"),v=_("a"),v.textContent="Назад ко входу",f(s,"class","m-b-xs"),f(n,"class","content txt-center m-b-sm"),f(w,"class","txt"),f(a,"type","submit"),f(a,"class","btn btn-lg btn-block"),a.disabled=o[2],K(a,"btn-loading",o[2]),f(e,"class","m-b-base"),f(v,"href","/login"),f(v,"class","link-hint"),f(C,"class","content txt-center")},m(i,$){g(i,e,$),c(e,n),c(n,s),c(s,l),m&&m.m(s,null),c(e,t),j(r,e,null),c(e,p),j(d,e,null),c(e,u),c(e,a),c(a,w),g(i,S,$),g(i,C,$),c(C,v),h=!0,F||(E=[A(e,"submit",V(o[4])),U(X.call(null,v))],F=!0)},p(i,$){i[3]?m?m.p(i,$):(m=W(i),m.c(),m.m(s,null)):m&&(m.d(1),m=null);const G={};$&769&&(G.$$scope={dirty:$,ctx:i}),r.$set(G);const H={};$&770&&(H.$$scope={dirty:$,ctx:i}),d.$set(H),(!h||$&4)&&(a.disabled=i[2]),(!h||$&4)&&K(a,"btn-loading",i[2])},i(i){h||(T(r.$$.fragment,i),T(d.$$.fragment,i),h=!0)},o(i){R(r.$$.fragment,i),R(d.$$.fragment,i),h=!1},d(i){i&&(b(e),b(S),b(C)),m&&m.d(),J(r),J(d),F=!1,Q(E)}}}function se(o){let e,n;return e=new N({props:{$$slots:{default:[te]},$$scope:{ctx:o}}}),{c(){z(e.$$.fragment)},m(s,l){j(e,s,l),n=!0},p(s,[l]){const t={};l&527&&(t.$$scope={dirty:l,ctx:s}),e.$set(t)},i(s){n||(T(e.$$.fragment,s),n=!0)},o(s){R(e.$$.fragment,s),n=!1},d(s){J(e,s)}}}function le(o,e,n){let s,{params:l}=e,t="",r="",p=!1;async function d(){if(!p){n(2,p=!0);try{await L.collection("_superusers").confirmPasswordReset(l==null?void 0:l.token,t,r),Y("Новый пароль суперпользователя успешно установлен."),Z("/")}catch(w){L.error(w)}n(2,p=!1)}}function u(){t=this.value,n(0,t)}function a(){r=this.value,n(1,r)}return o.$$set=w=>{"params"in w&&n(5,l=w.params)},o.$$.update=()=>{o.$$.dirty&32&&n(3,s=O.getJWTPayload(l==null?void 0:l.token).email||"")},[t,r,p,s,d,l,u,a]}class ae extends B{constructor(e){super(),D(this,e,le,se,M,{params:5})}}export{ae as default};
